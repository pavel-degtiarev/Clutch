!function(){"use strict";var e,t={913:function(e,t,r){r.d(t,{q5:function(){return Da},E$:function(){return xa},Y3:function(){return wa},YZ:function(){return ka}});var n,a,c=r(484),u=r.n(c),i=r(412),o=r.n(i),s=r(646),l=r.n(s),f=(r(600),r(294)),p=r(745),m=r(998),d=r(575),h=r(861),v=r(687),b=r.n(v),E=r(942),O=r(885),y=r(424),S="clutchDB";function g(){return(g=(0,h.Z)(b().mark((function e(){return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,y.X3)(S,1,{upgrade:function(e){function t(t,r,n){e.objectStoreNames.contains(t)||e.createObjectStore(t,{keyPath:"id",autoIncrement:!0}).createIndex(r,n)}t(n.FUEL,"date","fuelDate"),t(n.SERVICE,"date","serviceDate"),t(n.SPARE,"date","spareDate"),t(n.OTHER,"date","otherDate"),t(n.REPEAT,"serviceId","serviceId")}});case 2:return e.abrupt("return",a=e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function w(){if(!a)throw new Error("DB access error");return a}function x(){return(x=(0,h.Z)(b().mark((function e(){return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.close(),e.next=3,(0,y.Lj)(S);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(e){e.FUEL="fuel",e.SERVICE="service",e.SPARE="spare",e.OTHER="other",e.REPEAT="repeat"}(n||(n={}));var k=r(486),D=r.n(k);function R(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function C(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?R(Object(r),!0).forEach((function(t){(0,E.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):R(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function P(e){return T.apply(this,arguments)}function T(){return(T=(0,h.Z)(b().mark((function e(t){var r;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=w().transaction(t,"readonly"),e.next=3,r.store.getAll();case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function j(e,t,r){return N.apply(this,arguments)}function N(){return(N=(0,h.Z)(b().mark((function e(t,r,a){var c,u;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t!==n.REPEAT){e.next=2;break}return e.abrupt("return",[]);case 2:return c=w().transaction(t,"readonly"),e.next=5,c.store.index("date").getAll(IDBKeyRange.bound(r,a));case 5:return u=e.sent,e.abrupt("return",u);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Z(e){return F.apply(this,arguments)}function F(){return F=(0,h.Z)(b().mark((function e(t){var r,a;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=w().transaction(n.REPEAT,"readonly"),e.next=3,r.store.index("serviceId").get(IDBKeyRange.only(t));case 3:return a=e.sent,e.abrupt("return",a);case 5:case"end":return e.stop()}}),e)}))),F.apply(this,arguments)}function M(e,t,r){return I.apply(this,arguments)}function I(){return(I=(0,h.Z)(b().mark((function e(t,r,a){var c,u;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t!==n.REPEAT){e.next=2;break}return e.abrupt("return",{});case 2:return c=w().transaction(t,"readonly"),e.next=5,c.store.index("date").get(IDBKeyRange.bound(r,a));case 5:return u=e.sent,e.abrupt("return",u);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function A(e,t){return Y.apply(this,arguments)}function Y(){return(Y=(0,h.Z)(b().mark((function e(t,r){var n,a;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=w().transaction(t,"readonly"),e.next=3,n.store.get(IDBKeyRange.only(r));case 3:return a=e.sent,e.abrupt("return",a);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function H(e,t){return _.apply(this,arguments)}function _(){return(_=(0,h.Z)(b().mark((function e(t,r){var a,c,u,i,o,s,l;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t!==n.REPEAT){e.next=2;break}return e.abrupt("return",[]);case 2:return a=w().transaction(t,"readonly"),e.next=5,Promise.all([a.store.index("date").openCursor(IDBKeyRange.bound(0,r),"prev"),a.store.index("date").get(IDBKeyRange.lowerBound(r,!0))]);case 5:return c=e.sent,u=(0,O.Z)(c,2),i=u[0],o=u[1],s=i?i.value:null,l=o||null,e.abrupt("return",[s,l]);case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function U(e){return L.apply(this,arguments)}function L(){return(L=(0,h.Z)(b().mark((function e(t){var r,a;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t!==n.REPEAT){e.next=2;break}return e.abrupt("return",{});case 2:return r=w().transaction(t,"readonly"),e.next=5,r.store.index("date").openCursor(null,"prev");case 5:return a=e.sent,e.abrupt("return",a?a.value:{});case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function B(e){return V.apply(this,arguments)}function V(){return(V=(0,h.Z)(b().mark((function e(t){var r,a;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t!==n.REPEAT){e.next=2;break}return e.abrupt("return",0);case 2:return r=w().transaction(t,"readonly"),e.next=5,r.store.index("date").get(IDBKeyRange.lowerBound(0));case 5:if(a=e.sent){e.next=8;break}return e.abrupt("return",0);case 8:e.t0=t,e.next=e.t0===n.FUEL?11:e.t0===n.OTHER?12:e.t0===n.SERVICE?13:e.t0===n.SPARE?14:15;break;case 11:return e.abrupt("return",a.fuelDate);case 12:return e.abrupt("return",a.otherDate);case 13:return e.abrupt("return",a.serviceDate);case 14:return e.abrupt("return",a.spareDate);case 15:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function G(e){return W.apply(this,arguments)}function W(){return(W=(0,h.Z)(b().mark((function e(t){var r;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t!==n.REPEAT){e.next=2;break}return e.abrupt("return",0);case 2:return e.next=4,U(t);case 4:if(r=e.sent,!D().isEqual(r,{})){e.next=7;break}return e.abrupt("return",0);case 7:e.t0=t,e.next=e.t0===n.FUEL?10:e.t0===n.OTHER?11:e.t0===n.SERVICE?12:e.t0===n.SPARE?13:14;break;case 10:return e.abrupt("return",r.fuelDate);case 11:return e.abrupt("return",r.otherDate);case 12:return e.abrupt("return",r.serviceDate);case 13:return e.abrupt("return",r.spareDate);case 14:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function K(e,t,r){return X.apply(this,arguments)}function X(){return(X=(0,h.Z)(b().mark((function e(t,r,n){var a,c,u,i;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=w().transaction(t,"readwrite"),c=n?C(C({},r),{},{id:n}):r,e.next=4,a.store.put(c);case 4:return u=e.sent,i=C(C({},r),{},{id:u}),e.abrupt("return",i);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function J(e,t){return q.apply(this,arguments)}function q(){return(q=(0,h.Z)(b().mark((function e(t,r){var n;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=w().transaction(t,"readwrite"),e.next=3,n.store.delete(IDBKeyRange.only(r));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var z=(0,d.oM)({name:"repeatSlice",initialState:[],reducers:{clearRepeatSlice:function(e){return[]},setRepeatSlice:function(e,t){return t.payload},addToRepeatSlice:function(e,t){return e.push(t.payload),e}},extraReducers:function(e){e.addCase(ae.fulfilled,(function(e){return e})).addCase(ce.fulfilled,(function(e){return e}))}}),Q=z.reducer,$=z.actions,ee=$.clearRepeatSlice,te=$.setRepeatSlice,re=$.addToRepeatSlice,ne=(0,d.hg)("repeatSlice/updateReminders",(0,h.Z)(b().mark((function e(){return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",xa.setReminders());case 1:case"end":return e.stop()}}),e)})))),ae=(0,d.hg)("repeatSlice/saveRepeat",function(){var e=(0,h.Z)(b().mark((function e(t,r){var a;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,K(n.REPEAT,t);case 2:return(a=e.sent)&&r.dispatch(re(t)),e.abrupt("return",a);case 5:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}()),ce=(0,d.hg)("repeatSlice/updateRepeat",function(){var e=(0,h.Z)(b().mark((function e(t,r){var a;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,K(n.REPEAT,t.formState,t.id);case 2:return(a=e.sent)&&r.dispatch(re(t.formState)),e.abrupt("return",a);case 5:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}()),ue=(0,d.oM)({name:"statSlice",initialState:{fuelStat:[],runStat:[],expenceStat:[]},reducers:{setFuelStat:function(e,t){return se(e.fuelStat,t)},setRunStat:function(e,t){return se(e.runStat,t)},setExpenceStat:function(e,t){return se(e.expenceStat,t)},clearFuelStat:function(e){e.fuelStat=[]},clearRunStat:function(e){e.runStat=[]},clearExpenceStat:function(e){e.expenceStat=[]}}}),ie=(0,d.hg)("statSlice/updateStats",function(){var e=(0,h.Z)(b().mark((function e(t){return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:wa.update(t);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),oe=((0,d.hg)("statSlice/updateFuelStat",function(){var e=(0,h.Z)(b().mark((function e(t){return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:wa.fuelController.update(t);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),(0,d.hg)("statSlice/updateRunStat",function(){var e=(0,h.Z)(b().mark((function e(t){return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:wa.runController.update(t);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),(0,d.hg)("statSlice/updateExpencesStat",function(){var e=(0,h.Z)(b().mark((function e(t){return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:wa.expencesController.update(t);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));function se(e,t){var r=e.find((function(e){return e.timestamp===t.payload.timestamp}));r?r.value=t.payload.value:e.push(t.payload)}var le,fe,pe,me,de,he=ue.reducer,ve=ue.actions,be=ve.setFuelStat,Ee=ve.setRunStat,Oe=ve.setExpenceStat,ye=ve.clearFuelStat,Se=ve.clearRunStat,ge=ve.clearExpenceStat,we=(0,d.oM)({name:"fuelSlice",initialState:[],reducers:{},extraReducers:function(e){e.addCase(xe.fulfilled,(function(e,t){return t.payload})).addCase(ke.fulfilled,(function(e,t){return e.push(t.payload),e}))}}).reducer,xe=(0,d.hg)("fuelSlice/fetchAllFuel",(0,h.Z)(b().mark((function e(){return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,P(n.FUEL);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))),ke=(0,d.hg)("fuelSlice/saveFuel",function(){var e=(0,h.Z)(b().mark((function e(t,r){var a;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,K(n.FUEL,t);case 2:return(a=e.sent)&&(r.dispatch(ie(t.fuelDate)),r.dispatch(ne())),e.abrupt("return",a);case 5:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}()),De=(0,d.oM)({name:"otherSlice",initialState:[],reducers:{},extraReducers:function(e){e.addCase(Re.fulfilled,(function(e,t){return t.payload})).addCase(Ce.fulfilled,(function(e,t){return e.push(t.payload),e}))}}).reducer,Re=(0,d.hg)("otherSlice/fetchAllOther",(0,h.Z)(b().mark((function e(){return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,P(n.OTHER);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))),Ce=(0,d.hg)("otherSlice/saveOther",function(){var e=(0,h.Z)(b().mark((function e(t,r){var a;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,K(n.OTHER,t);case 2:return(a=e.sent)&&r.dispatch(oe(t.otherDate)),e.abrupt("return",a);case 5:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}()),Pe=(0,d.oM)({name:"serviceSlice",initialState:[],reducers:{},extraReducers:function(e){e.addCase(Te.fulfilled,(function(e,t){return e})).addCase(je.fulfilled,(function(e,t){return e}))}}).reducer,Te=(0,d.hg)("serviceSlice/fetchAllService",(0,h.Z)(b().mark((function e(){return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,P(n.SERVICE);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))),je=(0,d.hg)("serviceSlice/saveService",function(){var e=(0,h.Z)(b().mark((function e(t,r){var a;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,K(n.SERVICE,t);case 2:return(a=e.sent)&&(r.dispatch(oe(t.serviceDate)),r.dispatch(ne())),e.abrupt("return",a);case 5:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}()),Ne=(0,d.oM)({name:"spareSlice",initialState:[],reducers:{},extraReducers:function(e){e.addCase(Ze.fulfilled,(function(e,t){return t.payload})).addCase(Fe.fulfilled,(function(e,t){return e.push(t.payload),e}))}}).reducer,Ze=(0,d.hg)("spareSlice/fetchAllSpare",(0,h.Z)(b().mark((function e(){return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,P(n.SPARE);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))),Fe=(0,d.hg)("spareSlice/saveSpare",function(){var e=(0,h.Z)(b().mark((function e(t,r){var a;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,K(n.SPARE,t);case 2:return(a=e.sent)&&r.dispatch(oe(t.spareDate)),e.abrupt("return",a);case 5:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}()),Me=(0,d.xC)({reducer:{fuel:we,other:De,service:Pe,repeat:Q,spare:Ne,stat:he}}),Ie=m.I0,Ae=r(671),Ye=r(144),He=r(982),_e=r(340),Ue=r(590),Le=r(120);function Be(e){return e.hasOwnProperty("fuelDate")}function Ve(e){return e.hasOwnProperty("otherDate")}function Ge(e){return e.hasOwnProperty("spareDate")}function We(e){return e.hasOwnProperty("serviceDate")}!function(e){e.DAY="days",e.MONTH="months",e.YEAR="years"}(le||(le={})),function(e){e.MONTH="month",e.YEAR="year"}(fe||(fe={})),function(e){e.STAT="stat",e.LIST="list"}(pe||(pe={})),(de=me||(me={})).ONE_DAY="день",de.TWO_TO_FOUR_DAYS="дня",de.MANY_DAYS="дней",de.ONE_MONTH="месяц",de.TWO_TO_FOUR_MONTHS="месяца",de.MANY_MONTHS="месяцев",de.ONE_YEAR="год",de.TWO_TO_FOUR_YEARS="года",de.MANY_YEARS="лет";var Ke,Xe,Je,qe=[{label:"дни",value:le.DAY},{label:"месяцы",value:le.MONTH},{label:"годы",value:le.YEAR}];!function(e){e[e.SINGLE=0]="SINGLE",e[e.MULTIPLE=1]="MULTIPLE",e[e.LONG=2]="LONG"}(Ke||(Ke={})),(Je=Xe||(Xe={})).RUN="км.",Je.MONEY="руб.",Je.VOLUME="л.";var ze=[{id:fe.MONTH,title:"Месяц"},{id:fe.YEAR,title:"Год"}];function Qe(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function $e(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Qe(Object(r),!0).forEach((function(t){(0,E.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Qe(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var et=function(){function e(t,r,n){(0,Ae.Z)(this,e),this.tile={title:t,units:r,value:0,chartData:[]},this.store=n,this.dispatch=n.dispatch,this.onUpdateCallback=null,this.timeInterval=fe.MONTH}return(0,Ye.Z)(e,[{key:"setTileLegend",value:function(e){var t=e[e.length-1],r=e.map((function(e){return e.value})),n=this.timeInterval===fe.MONTH?6:3;switch(!0){case r.length>n:r=r.slice(-n);break;case r.length<n:r=new Array(n-r.length).fill(0).concat(r)}return $e($e({},this.tile),{},{value:t.value,chartData:r})}},{key:"setOnUpdateCallback",value:function(e){this.onUpdateCallback=e}},{key:"clearController",value:function(){this.tile=$e($e({},this.tile),{},{value:0,chartData:[]}),this.onUpdateCallback&&this.onUpdateCallback()}}]),e}();var tt=function(e){(0,_e.Z)(s,e);var t,r,a,c,i,o=(c=s,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=(0,Le.Z)(c);if(i){var r=(0,Le.Z)(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return(0,Ue.Z)(this,e)});function s(e){var t;return(0,Ae.Z)(this,s),(t=o.call(this,"Затраты","руб.",e)).dbNames=[n.FUEL,n.SERVICE,n.SPARE,n.OTHER],t}return(0,Ye.Z)(s,[{key:"initController",value:(a=(0,h.Z)(b().mark((function e(){var t,r,n,a,c,i,o;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.dispatch(ge()),u()().startOf(this.timeInterval),e.next=4,Promise.all(this.dbNames.map((function(e){return B(e)})));case 4:if(!(t=e.sent).every((function(e){return 0===e}))){e.next=7;break}return e.abrupt("return");case 7:return t=t.filter((function(e){return 0!==e})),r=u()(Math.min.apply(Math,(0,He.Z)(t))),e.next=11,Promise.all(this.dbNames.map((function(e){return G(e)})));case 11:n=e.sent,a=u()(Math.max.apply(Math,(0,He.Z)(n))),c=r.startOf(this.timeInterval),i=r.endOf(this.timeInterval);case 15:if(!c.isSameOrBefore(a)){e.next=24;break}return e.next=18,this.createStatRecord(c,i);case 18:(o=e.sent)&&this.dispatch(Oe(o)),c=i.add(1,this.timeInterval).startOf(this.timeInterval),i=c.endOf(this.timeInterval),e.next=15;break;case 24:this.tile=this.setTileLegend(this.store.getState().stat.expenceStat),this.onUpdateCallback&&this.onUpdateCallback();case 26:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"createStatRecord",value:(r=(0,h.Z)(b().mark((function e(t,r){var n,a,c;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(this.dbNames.map((function(e){return j(e,t.valueOf(),r.valueOf())})));case 2:if(!(n=e.sent).every((function(e){return 0===e.length}))){e.next=5;break}return e.abrupt("return",{timestamp:t.valueOf(),value:0});case 5:return a=n.filter((function(e){return 0!==e.length})),c=0,a.forEach((function(e){switch(!0){case Be(e[0]):c+=e.reduce((function(e,t){return e+t.fuelCost}),0);break;case Ve(e[0]):c+=e.reduce((function(e,t){return e+t.otherPrice}),0);break;case Ge(e[0]):c+=e.reduce((function(e,t){return e+t.sparePrice}),0);break;case We(e[0]):c+=e.reduce((function(e,t){return e+t.serviceTotal}),0)}})),e.abrupt("return",{timestamp:t.valueOf(),value:c});case 9:case"end":return e.stop()}}),e,this)}))),function(e,t){return r.apply(this,arguments)})},{key:"update",value:(t=(0,h.Z)(b().mark((function e(t){var r,n,a,c;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=u()(t),n=r.startOf(this.timeInterval),a=r.endOf(this.timeInterval),e.next=5,this.createStatRecord(n,a);case 5:(c=e.sent)&&this.dispatch(Oe(c)),this.tile=this.setTileLegend(this.store.getState().stat.expenceStat),this.onUpdateCallback&&this.onUpdateCallback();case 9:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})}]),s}(et);var rt=function(e){(0,_e.Z)(s,e);var t,r,a,c,i,o=(c=s,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=(0,Le.Z)(c);if(i){var r=(0,Le.Z)(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return(0,Ue.Z)(this,e)});function s(e){var t;return(0,Ae.Z)(this,s),(t=o.call(this,"Расход топлива","л./100 км.",e)).dbName=n.FUEL,t}return(0,Ye.Z)(s,[{key:"initController",value:(a=(0,h.Z)(b().mark((function e(){var t,r,n,a,c,i;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.dispatch(ye()),e.next=3,B(this.dbName);case 3:if(0!==(t=e.sent)){e.next=6;break}return e.abrupt("return");case 6:return e.t0=u(),e.next=9,G(this.dbName);case 9:e.t1=e.sent,r=(0,e.t0)(e.t1),n=u()(t),a=n.startOf(this.timeInterval),c=n.endOf(this.timeInterval);case 14:if(!a.isSameOrBefore(r)){e.next=23;break}return e.next=17,this.createStatRecord(a,c);case 17:(i=e.sent)&&this.dispatch(be(i)),a=c.add(1,this.timeInterval).startOf(this.timeInterval),c=a.endOf(this.timeInterval),e.next=14;break;case 23:this.tile=this.setTileLegend(this.store.getState().stat.fuelStat),this.onUpdateCallback&&this.onUpdateCallback();case 25:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"createStatRecord",value:(r=(0,h.Z)(b().mark((function e(t,r){var n,a,c,u,i,o;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j(this.dbName,t.valueOf(),r.valueOf());case 2:if(0!==(n=e.sent).length){e.next=5;break}return e.abrupt("return",{timestamp:t.valueOf(),value:0});case 5:return a=r.add(1,"day").startOf("month"),c=a.endOf("month"),e.next=9,M(this.dbName,a.valueOf(),c.valueOf());case 9:return(u=e.sent)&&n.push(u),i=1===n.length?n[0].fuelRun:n[n.length-1].fuelRun-n[0].fuelRun,o=n.slice(0,-1).reduce((function(e,t){return e+t.fuelVolume}),0),e.abrupt("return",{timestamp:t.valueOf(),value:Math.round(1e3*o/i)/10});case 14:case"end":return e.stop()}}),e,this)}))),function(e,t){return r.apply(this,arguments)})},{key:"update",value:(t=(0,h.Z)(b().mark((function e(t){var r,n,a,c;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=u()(t),n=r.startOf(this.timeInterval),a=r.endOf(this.timeInterval),e.next=5,this.createStatRecord(n,a);case 5:(c=e.sent)&&this.dispatch(be(c)),this.tile=this.setTileLegend(this.store.getState().stat.fuelStat),this.onUpdateCallback&&this.onUpdateCallback();case 9:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})}]),s}(et);var nt=function(e){(0,_e.Z)(s,e);var t,r,a,c,i,o=(c=s,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=(0,Le.Z)(c);if(i){var r=(0,Le.Z)(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return(0,Ue.Z)(this,e)});function s(e){var t;return(0,Ae.Z)(this,s),(t=o.call(this,"Пробег","км.",e)).dbName=n.FUEL,t}return(0,Ye.Z)(s,[{key:"initController",value:(a=(0,h.Z)(b().mark((function e(){var t,r,n,a,c,i;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.dispatch(Se()),e.next=3,B(this.dbName);case 3:if(0!==(t=e.sent)){e.next=6;break}return e.abrupt("return");case 6:return r=u()(t),n=r.startOf(this.timeInterval),a=r.endOf(this.timeInterval),e.t0=u(),e.next=12,G(this.dbName);case 12:e.t1=e.sent,c=(0,e.t0)(e.t1);case 14:if(!n.isSameOrBefore(c)){e.next=23;break}return e.next=17,this.createStatRecord(n,a);case 17:(i=e.sent)&&this.dispatch(Ee(i)),n=a.add(1,this.timeInterval).startOf(this.timeInterval),a=n.endOf(this.timeInterval),e.next=14;break;case 23:this.tile=this.setTileLegend(this.store.getState().stat.runStat),this.onUpdateCallback&&this.onUpdateCallback();case 25:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"createStatRecord",value:(r=(0,h.Z)(b().mark((function e(t,r){var n;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j(this.dbName,t.valueOf(),r.valueOf());case 2:if(0!==(n=e.sent).length){e.next=5;break}return e.abrupt("return",{timestamp:t.valueOf(),value:0});case 5:return e.abrupt("return",{timestamp:t.valueOf(),value:n[n.length-1].fuelRun-n[0].fuelRun});case 6:case"end":return e.stop()}}),e,this)}))),function(e,t){return r.apply(this,arguments)})},{key:"update",value:(t=(0,h.Z)(b().mark((function e(t){var r,n,a,c;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=u()(t),n=r.startOf(this.timeInterval),a=r.endOf(this.timeInterval),e.next=5,this.createStatRecord(n,a);case 5:(c=e.sent)&&this.dispatch(Ee(c)),this.tile=this.setTileLegend(this.store.getState().stat.runStat),this.onUpdateCallback&&this.onUpdateCallback();case 9:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})}]),s}(et),at=function(){function e(t){return(0,Ae.Z)(this,e),(0,E.Z)(this,"_controllers",[]),e._instance||(e._instance=this),this._store=t,this.runController=new nt(this._store),this.fuelController=new rt(this._store),this.expencesController=new tt(this._store),this._controllers=[this.runController,this.fuelController,this.expencesController],e._instance}var t,r;return(0,Ye.Z)(e,[{key:"init",value:(r=(0,h.Z)(b().mark((function e(){return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(this._controllers.map(function(){var e=(0,h.Z)(b().mark((function e(t){return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t.initController());case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 2:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"update",value:(t=(0,h.Z)(b().mark((function e(t){return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(this._controllers.map(function(){var e=(0,h.Z)(b().mark((function e(r){return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",r.update(t));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 2:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"tiles",get:function(){return this._controllers.map((function(e){return e.tile}))}},{key:"clearTiles",value:function(){this._controllers.forEach((function(e){return e.clearController()}))}},{key:"setOnUpdateCallback",value:function(e){this._controllers.forEach((function(t){return t.setOnUpdateCallback(e)}))}},{key:"setTimeInterval",value:function(e){this._controllers.forEach((function(t){return t.timeInterval=e})),this.init()}}]),e}();function ct(e){var t=e.Form,r=e.getValidate,n=e.finalCheck;return f.createElement(t,{getValidate:r,finalCheck:n})}var ut=r(184),it=r.n(ut),ot="CEnlNbKEL62xbdEf_M7i",st="mYkcl5IRfntJ1u9s2Q9B",lt="uW_JyGdrCBsMCLnUSNgv",ft="nW62h5vJY4AAJU_j6ALF";function pt(e){var t=e.title,r=void 0===t?"":t,n=e.auxStyles,a=e.clickHandler,c=it()("QVDFfTY7ezo_7gT0SLNA",st,"wE__MDZms2smLEMcACR3",n);return f.createElement("button",{type:"button",className:c,onClick:a},r)}var mt,dt;function ht(e){var t=e.auxStyles,r=e.children;return f.createElement("div",{className:it()("hyM7bP_BnG1ojEoOPCM5",t)},r)}function vt(e){var t=e.name,r=e.value,n=e.type,a=void 0===n?mt.TEXT:n,c=e.inputMode,u=e.disabled,i=void 0!==u&&u,o=e.changeHandler,s=e.focusHandler,l=e.blurHandler,p=it()("ivSWWJCIysSNnI_q4hDr",st),m=(0,f.useState)(r),d=(0,O.Z)(m,2),h=d[0],v=d[1],b=(0,f.useCallback)((function(e){var t=o?o(e):e;return v(t),t}),[o]);return(0,f.useEffect)((function(){return v(r)}),[r]),f.createElement("input",{className:p,type:a,name:t,id:t,value:h,inputMode:c,placeholder:" ",onChange:function(e){return b(e.target.value)},onBlur:l,onFocus:s,disabled:i})}function bt(e){var t=e.inputName,r=e.label,n=e.auxStyles;return f.createElement("label",{className:it()("eksE7fbdiKEoiWUkzrIq",st,n),htmlFor:t},r)}function Et(e){var t=e.name,r=e.label,n=e.value,a=e.auxStyles,c=e.disabled,u=void 0!==c&&c,i=e.children,o=e.changeHandler,s=e.focusHandler,l=e.blurHandler;return f.createElement(ht,{auxStyles:a},f.createElement(vt,{name:t,value:n,disabled:u,inputMode:dt.TEXT,type:mt.DATE,changeHandler:o,focusHandler:s,blurHandler:l}),f.createElement(bt,{inputName:t,label:r}),i)}!function(e){e.TEXT="text",e.NUMBER="number",e.DATE="date",e.CHECKBOX="checkbox"}(mt||(mt={})),function(e){e.TEXT="text",e.NUMERIC="numeric",e.DECIMAL="decimal"}(dt||(dt={}));var Ot=function(e,t){return e?"".concat(e," ").concat(t):e};function yt(e,t){var r,n=+e-10*Math.floor(+e/10),a=(r={},(0,E.Z)(r,le.DAY,{ONE:me.ONE_DAY,TWO_TO_FOUR:me.TWO_TO_FOUR_DAYS,MANY:me.MANY_DAYS}),(0,E.Z)(r,le.MONTH,{ONE:me.ONE_MONTH,TWO_TO_FOUR:me.TWO_TO_FOUR_MONTHS,MANY:me.MANY_MONTHS}),(0,E.Z)(r,le.YEAR,{ONE:me.ONE_YEAR,TWO_TO_FOUR:me.TWO_TO_FOUR_YEARS,MANY:me.MANY_YEARS}),r);switch(!0){case+e>4&&+e<=20:case n>4||0===n:return a[t].MANY;case n>=2&&n<=4:return a[t].TWO_TO_FOUR}return a[t].ONE}function St(e){var t=e.InputComponent,r=e.name,n=e.label,a=e.value,c=e.suffix,u=e.disabled,i=e.changeHandler,o=e.auxStyles,s=e.children,l=(0,f.useState)(!1),p=(0,O.Z)(l,2),m=p[0],d=p[1],h=(0,f.useState)(a),v=(0,O.Z)(h,2),b=v[0],E=v[1];return(0,f.useEffect)((function(){return E(a)}),[a]),f.createElement(ht,{auxStyles:o},m?f.createElement(t,{name:r,value:b,disabled:u,blurHandler:function(e){E(e.target.value),d(!m)},changeHandler:i}):f.createElement(t,{name:r,value:Ot(b,c),disabled:u,focusHandler:function(){return d(!m)},changeHandler:i}),f.createElement(bt,{inputName:r,label:n}),s)}var gt,wt=function(e){var t=e.replace(/[^0-9\,\.]/g,"").replace(/\,/,"."),r=t.match(/\./g);return r&&r.length>1?t.replace(/\.$/,""):t},xt=function(e){return e.replace(/\D/g,"")};function kt(e){var t=e.name,r=e.value,n=e.disabled,a=e.focusHandler,c=e.blurHandler,u=e.changeHandler,i=(0,f.useCallback)(xt,[]);return f.createElement(vt,{name:t,value:r,inputMode:dt.NUMERIC,disabled:n,changeHandler:function(e){return u?u(i(e)):i(e)},focusHandler:a,blurHandler:c})}function Dt(e){var t=e.name,r=e.value,n=e.disabled,a=e.focusHandler,c=e.blurHandler,u=e.changeHandler,i=(0,f.useCallback)(wt,[]);return f.createElement(vt,{name:t,value:r,inputMode:dt.DECIMAL,disabled:n,changeHandler:function(e){return u?u(i(e)):i(e)},focusHandler:a,blurHandler:c})}function Rt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Ct(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Rt(Object(r),!0).forEach((function(t){(0,E.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Rt(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Pt(e){var t=e.validate,r=e.Control,n=r.props.changeHandler,a=Ct(Ct({},r.props),{},{changeHandler:function(e){var a=n?n(e):e;return t(r.props.name,a),a}});return r.type(Ct({},a))}function Tt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function jt(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Tt(Object(r),!0).forEach((function(t){(0,E.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Tt(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}!function(e){e.ROLLUP_TOGGLED="ROLLUP_TOGGLED",e.FORM_SELECTED="FORM_SELECTED",e.SUBFORM_SELECTED="SUBFORM_SELECTED",e.FORM_CLOSED="FORM_CLOSED",e.SUBFORM_CLOSED="SUBFORM_CLOSED"}(gt||(gt={}));var Nt={rollupOpened:!1,currentForm:null,currentSubform:null};function Zt(e,t){switch(t.type){case gt.ROLLUP_TOGGLED:return jt(jt({},e),{},{rollupOpened:!e.rollupOpened});case gt.FORM_SELECTED:return jt(jt({},e),{},{currentForm:t.payload});case gt.SUBFORM_SELECTED:return jt(jt({},e),{},{currentSubform:t.payload});case gt.FORM_CLOSED:return jt(jt({},e),{},{currentForm:null});case gt.SUBFORM_CLOSED:return jt(jt({},e),{},{currentSubform:null})}return e}var Ft=(0,f.createContext)({});function Mt(e){var t=e.children,r=(0,f.useReducer)(Zt,Nt),n=(0,O.Z)(r,2),a=n[0],c=n[1];return f.createElement(Ft.Provider,{value:{state:a,toggleRollup:function(){return c({type:gt.ROLLUP_TOGGLED})},showForm:function(e){return c((t=e,{type:gt.FORM_SELECTED,payload:t}));var t},showSubform:function(e){return c((t=e,{type:gt.SUBFORM_SELECTED,payload:t}));var t},closeForm:function(){return c({type:gt.FORM_CLOSED})},closeSubform:function(){return c({type:gt.SUBFORM_CLOSED})}}},t)}var It={fuelDate:u()().format("YYYY-MM-DD"),fuelRun:"",fuelCost:"",fuelPrice:"",fuelVolume:""},At={spareDate:u()().format("YYYY-MM-DD"),spareTitle:"",sparePrice:""},Yt={serviceDate:u()().format("YYYY-MM-DD"),serviceDescription:"",serviceRun:"",serviceTotal:"",serviceRepeat:!1,serviceTotalDetails:{},serviceRepeatDetails:{}},Ht={otherDate:u()().format("YYYY-MM-DD"),otherTitle:"",otherPrice:""},_t={repeatId:0,repeatingRun:"",repeatingTime:"",repeatByRun:!1,repeatByTime:!1,repeatTimeSlot:qe[1].value},Ut={services:[],spares:[]};function Lt(e,t){return{key:e,payload:t}}function Bt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Vt(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Bt(Object(r),!0).forEach((function(t){(0,E.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Bt(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Gt={fuelState:It,serviceState:Yt,spareState:At,otherState:Ht,repeatState:_t,detailsState:Ut};function Wt(e,t){return t.key&&t.payload?Vt(Vt({},e),{},(0,E.Z)({},t.key,t.payload)):e}function Kt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Xt(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Kt(Object(r),!0).forEach((function(t){(0,E.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Kt(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Jt=(0,f.createContext)({});function qt(e){var t=e.children,r=(0,f.useReducer)(Wt,Gt),n=(0,O.Z)(r,2),a=n[0],c=n[1];return f.createElement(Jt.Provider,{value:Xt(Xt({},a),{},{updateFuelForm:function(e){return c(Lt("fuelState",e))},updateServiceForm:function(e){return c(Lt("serviceState",e))},updateSpareForm:function(e){return c(Lt("spareState",e))},updateOtherForm:function(e){return c(Lt("otherState",e))},updateRepeatForm:function(e){return c(Lt("repeatState",e))},updateDetailsForm:function(e){return c(Lt("detailsState",e))}})},t)}var zt={popup:"oYP9i7TpK3UPedXbiOR4",popupOpened:"H9B16_v32NbeKqiiwerw",popupSmall:"r6TWpTeEPXO1RuhZgRIF",container:"moNExpx7OBR5fJD3Rw7N",inactive:"UshTbBsZbOaRsDvxsKWB",close:"K3IwYFGLLNYAXor0xoig",containerOpened:"TEnCv0kSDFpNl8b2tkid",saveButton:"QoqdJsI29M6tadqIAGkk",header:"LcQpZba2E5TpM732Yqc3",form:"CQdf58YYNJaPYmEPqWRI",field:"LV8JbYug7a1aH8JeB4SA",checkbox:"b6hQDd35I8oEzhxgnh9G",fieldGroup:"W342vvq4j74hOkzHjCnQ",fieldGroupHorizontal:"fdbJQaBjxicWeiMku4xx"};function Qt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function $t(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Qt(Object(r),!0).forEach((function(t){(0,E.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Qt(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function er(e){var t=$t($t({},e),{},{fuelDate:String(u()(e.fuelDate).toDate().valueOf())});return Object.keys(t).forEach((function(e){return t[e]=Number(t[e])})),t}function tr(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function rr(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?tr(Object(r),!0).forEach((function(t){(0,E.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):tr(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function nr(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return ar(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?ar(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,u=!0,i=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return u=e.done,e},e:function(e){i=!0,c=e},f:function(){try{u||null==r.return||r.return()}finally{if(i)throw c}}}}function ar(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function cr(e,t){return ur.apply(this,arguments)}function ur(){return ur=(0,h.Z)(b().mark((function e(t,r){var n,a,c;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=nr(r),e.prev=1,n.s();case 3:if((a=n.n()).done){e.next=11;break}return c=a.value,e.next=7,c(t);case 7:if(e.sent){e.next=9;break}return e.abrupt("return",!1);case 9:e.next=3;break;case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(1),n.e(e.t0);case 16:return e.prev=16,n.f(),e.finish(16);case 19:return e.abrupt("return",!0);case 20:case"end":return e.stop()}}),e,null,[[1,13,16,19]])}))),ur.apply(this,arguments)}function ir(e,t){return!!e()||(alert(t),!1)}var or=[function(e){return ir((function(){return!Object.values(e).includes("")}),"Все поля должны быть заполнены!")},function(e){return ir((function(){return 0!==Number(e.fuelRun)}),"Пробег не может быть нулевым!")},function(e){return ir((function(){return 0!==Number(e.fuelVolume)}),"Объем не может быть нулевым!")},function(){var e=(0,h.Z)(b().mark((function e(t){var r,a,c,i,o,s,l,f;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Number(t.fuelRun),a=u()(t.fuelDate),e.next=4,Promise.all([H(n.FUEL,a.valueOf()),H(n.SERVICE,a.valueOf())]);case 4:return c=e.sent,i=(0,O.Z)(c,2),o=i[0],s=i[1],l=Math.max(o[0]?o[0].fuelRun:-1/0,s[0]?s[0].serviceRun:-1/0),f=Math.min(o[1]?o[1].fuelRun:1/0,s[1]?s[1].serviceRun:1/0),e.abrupt("return",ir((function(){return r>=l&&r<=f}),"Пробег на эту дату должен быть в пределах от ".concat(l," до ").concat(f," км.")));case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()];function sr(){return(sr=(0,h.Z)(b().mark((function e(t){return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,cr(t,or);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function lr(e){var t=e.name,r=e.label,n=e.value,a=e.auxStyles,c=e.disabled,u=void 0!==c&&c,i=e.children,o=e.changeHandler,s=e.focusHandler,l=e.blurHandler;return f.createElement(ht,{auxStyles:a},f.createElement(vt,{name:t,value:n,inputMode:dt.TEXT,disabled:u,changeHandler:o,focusHandler:s,blurHandler:l}),f.createElement(bt,{inputName:t,label:r}),i)}function fr(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function pr(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?fr(Object(r),!0).forEach((function(t){(0,E.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):fr(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var mr=[function(e){return ir((function(){return!Object.values(e).includes("")}),"Все поля должны быть заполнены!")},function(e){return ir((function(){return Number(e.otherPrice)>=0}),"Цена не может быть отрицательной!")}];function dr(){return(dr=(0,h.Z)(b().mark((function e(t){return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,cr(t,mr);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function hr(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function vr(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?hr(Object(r),!0).forEach((function(t){(0,E.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):hr(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function br(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Er(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?br(Object(r),!0).forEach((function(t){(0,E.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):br(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Or(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function yr(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Or(Object(r),!0).forEach((function(t){(0,E.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Or(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Sr=[function(e){return ir((function(){return!Object.values(e).includes("")}),"Все поля должны быть заполнены!")}];function gr(){return(gr=(0,h.Z)(b().mark((function e(t){return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,cr(t,Sr);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function wr(e){var t=e.label,r=e.auxClassNames,n=e.disabled,a=void 0!==n&&n,c=e.handler,u=it()("Zz316SkznBfZgQxIJTxS",(0,E.Z)({},"QPg3Lb13A9RYIRwp0GmR",a),r);return f.createElement("button",{className:u,type:"button","aria-label":t,onClick:a?void 0:c})}function xr(e){var t=e.name,r=e.label,n=e.auxStyles,a=e.isChecked,c=e.children,u=e.changeHandler,i=(0,f.useState)(a),o=(0,O.Z)(i,2),s=o[0],l=o[1],p=(0,f.useCallback)((function(){var e=!s;u&&u(e),l(e)}),[u]);return(0,f.useEffect)((function(){return l(a)}),[a]),f.createElement("div",{className:it()("YyX6ue9lDA0NEr9bhqbm",n)},f.createElement("input",{id:t,name:t,className:"yUKLCaO5uz9Qx1H1j6xL",type:"checkbox",checked:s,onChange:p}),f.createElement(bt,{inputName:t,label:r,auxStyles:"A88V4S8S5t7LFbiVnls8"}),c)}function kr(e){return{serviceId:0,repeatByRun:e.repeatByRun,repeatingRun:Number(e.repeatingRun),repeatByTime:e.repeatByTime,repeatingTime:Number(e.repeatingTime),repeatTimeSlot:e.repeatTimeSlot}}function Dr(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Rr(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Dr(Object(r),!0).forEach((function(t){(0,E.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Dr(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Cr=[function(e){return ir((function(){return!Object.values(e).includes("")}),"Все поля должны быть заполнены!")},function(){var e=(0,h.Z)(b().mark((function e(t){var r,a,c,i,o,s,l,f;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Number(t.serviceRun),a=u()(t.serviceDate),e.next=4,Promise.all([H(n.FUEL,a.valueOf()),H(n.SERVICE,a.valueOf())]);case 4:return c=e.sent,i=(0,O.Z)(c,2),o=i[0],s=i[1],l=Math.max(o[0]?o[0].fuelRun:-1/0,s[0]?s[0].serviceRun:-1/0),f=Math.min(o[1]?o[1].fuelRun:1/0,s[1]?s[1].serviceRun:1/0),e.abrupt("return",ir((function(){return r>=l&&r<=f}),"Пробег на эту дату должен быть в пределах от ".concat(l," до ").concat(f," км.")));case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()];function Pr(){return(Pr=(0,h.Z)(b().mark((function e(t){return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,cr(t,Cr);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Tr(e){var t=e.horizontal,r=void 0!==t&&t,n=e.children,a=it()("iWQL4qeCoTm0DEj37h7W",(0,E.Z)({},"xeSkPralxzPYKlAsOKTg",r));return f.createElement("div",{className:a},n)}function jr(e){var t=e.name,r=e.options,n=e.selected,a=e.disabled,c=void 0!==a&&a,u=e.changeHandler;return f.createElement("select",{name:t,id:t,className:"r2CJs3oQAa68qW9g0hJ8",defaultValue:n,disabled:c,onChange:function(e){return u&&u(e.target.value)}},r.map((function(e,t){return f.createElement("option",{key:t,value:e.value},e.label)})))}var Nr=[function(e){return ir((function(){return!e.repeatByRun||!!e.repeatingRun}),"Не указан пробег!")},function(e){return ir((function(){return!e.repeatByTime||!!e.repeatingTime}),"Не указан период времени!")}];function Zr(){return(Zr=(0,h.Z)(b().mark((function e(t){return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,cr(t,Nr);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Fr(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Mr(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Fr(Object(r),!0).forEach((function(t){(0,E.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Fr(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Ir="Oz_5d1eqlZwIut4e39nZ",Ar="ew7FTBD441fGabDZ2iM2",Yr="Q2h4rf98twKHu2RSj5HX",Hr="jf4ODEj7i7TnkcQfVi25";function _r(e){var t=e.children;return f.createElement("div",{className:Ar},t)}function Ur(e){var t=e.headers,r=e.children,n=e.addRowHandler;return f.createElement("div",{className:"F9QNGcwxHp8fvIjmac7y"},f.createElement("div",{className:it()("FRENuZOQ9pvaVoK0_awc",Ar,"HzfmJq1c5RreaUJIKUNs")},f.createElement("p",{className:it()(ft,Yr)},t[0]),f.createElement("p",{className:Hr},t[1])),f.createElement("div",{className:"BULAytvNtfxb9AxS3A91"},r,f.createElement(_r,null,f.createElement(pt,{auxStyles:"p6aVj9RHiTcIYhk2DZwr",clickHandler:function(){return n()}}))))}function Lr(e){var t=e.children,r=e.deleteHandler,n=(0,f.useRef)(null),a=(0,f.useState)(0),c=(0,O.Z)(a,2),u=c[0],i=c[1],o=(0,f.useState)(!1),s=(0,O.Z)(o,2),l=s[0],p=s[1],m=(0,f.useCallback)((function(e){i(e.changedTouches[0].pageX)}),[]),d=(0,f.useCallback)((function(e){if(n.current){var t=e.changedTouches[0].pageX-u;Math.abs(t)<=40?n.current.style.left="".concat(t,"px"):(t<0&&p(!0),t>0&&l&&p(!1))}}),[n,u]),h=(0,f.useCallback)((function(){n.current&&(n.current.style.left="")}),[n]);return f.createElement("div",{className:Ar,draggable:"true",ref:n,onTouchStart:m,onTouchMove:d,onTouchEnd:h},t,l&&f.createElement(wr,{auxClassNames:"YBhTznA19RwiCtfom_3I",handler:function(){return r()}}))}var Br="J8w4xdCmhtfwhgvQL2PD";function Vr(e){var t=e.name,r=e.id,n=e.title,a=e.checked,c=e.onCheck,u=e.themeOnLight,i="".concat(t,"-").concat(r),o=it()("YsUBtuuA19gZCdX2MM8Y",u?"gpCGAhoc2nfXjmYiUuNX":"g7wDFGZXjtuW06843jjA");return f.createElement("div",{className:"I2rSiFOsSu9rJXzpz0H7"},f.createElement("input",{className:Br,type:"radio",name:t,id:i,value:r,defaultChecked:a,onClick:function(){return c(r)}}),f.createElement("label",{className:o,htmlFor:i},n))}function Gr(e){var t=e.tabs,r=e.name,n=e.changedHandler,a=e.themeOnLight,c=void 0!==a&&a;return f.createElement("section",{className:"k1sb6miWHjRQapfJXg_s"},t.map((function(e,t){var a=0===t;return f.createElement(Vr,{key:t,name:r,title:e.title,id:e.id,checked:a,onCheck:function(){return n(e)},themeOnLight:c})})))}var Wr=(0,f.createContext)({});function Kr(e){var t=e.tabInfo,r=e.name,n=e.changedHandler,a=e.themeOnLight,c=void 0!==a&&a,u=e.children,i=(0,f.useState)(t[0]),o=(0,O.Z)(i,2),s=o[0],l=o[1],p=(0,f.useCallback)((function(e){n&&n(e.id),l(e)}),[n]);return f.createElement(Wr.Provider,{value:s},f.createElement(Gr,{tabs:t,name:r,changedHandler:p,themeOnLight:c}),u)}var Xr=[{id:"services",title:"Работы"},{id:"spares",title:"З/Ч, расходники"}];function Jr(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}var qr,zr=[function(e){return ir((function(){return![].concat((0,He.Z)(e.services),(0,He.Z)(e.spares)).map((function(e){return e.title})).includes("")}),"Пустые поля нужно заполнить или удалить!")}];function Qr(){return(Qr=(0,h.Z)(b().mark((function e(t){return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,cr(t,zr);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(e){e.FUEL="Топливо",e.SPARE="Расходники, запчасти",e.SERVICE="Сервис",e.OTHER="Прочее",e.REPEAT="Периодичность",e.DETAILS="Подробнее"}(qr||(qr={}));var $r,en=[{title:qr.FUEL,form:f.createElement(ct,{Form:function(e){var t=e.getValidate,r=e.finalCheck,n=(0,f.useContext)(Jt),a=n.fuelState,c=n.updateFuelForm,u=(0,f.useState)(a),i=(0,O.Z)(u,2),o=i[0],s=i[1],l=(0,f.useContext)(Ft).closeForm,p=Ie(),m=t(s);return f.createElement(f.Fragment,null,f.createElement("div",{className:zt.popupContent},f.createElement("form",{className:zt.form},f.createElement("div",{className:"_9P5nGG7omZ5tCumToIZg"},f.createElement(Pt,{validate:m,Control:f.createElement(Et,{name:"fuelDate",label:"Дата",auxStyles:"NoyyjP1YZn2SOBeF5v5O",value:o.fuelDate})}),f.createElement(Pt,{validate:m,Control:f.createElement(St,{InputComponent:kt,name:"fuelRun",label:"Пробег",value:o.fuelRun,auxStyles:"IZlOjPPpWIDLG_NtgY6g",suffix:Xe.RUN})}),f.createElement(Pt,{validate:m,Control:f.createElement(St,{InputComponent:Dt,name:"fuelCost",label:"Стоимость",value:o.fuelCost,auxStyles:"eQM7qn8i2CwFB8lBDcUr",suffix:Xe.MONEY})}),f.createElement(Pt,{validate:m,Control:f.createElement(St,{InputComponent:Dt,name:"fuelPrice",label:"Цена за литр",value:o.fuelPrice,auxStyles:"L9iOyCnCIx7VkiQ3KwPU",suffix:Xe.MONEY})}),f.createElement(Pt,{validate:m,Control:f.createElement(St,{InputComponent:Dt,name:"fuelVolume",label:"Объем",value:o.fuelVolume,auxStyles:"uAykZ8YlPGFHRJaPKuT9",suffix:Xe.VOLUME})})))),f.createElement(pt,{title:"Сохранить",auxStyles:zt.saveButton,clickHandler:(0,h.Z)(b().mark((function e(){return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r(o);case 2:if(!e.sent){e.next=7;break}return e.next=5,p(ke(er(o)));case 5:"fulfilled"===e.sent.meta.requestStatus&&(c(It),l());case 7:case"end":return e.stop()}}),e)})))}))},getValidate:function(e){return function(t,r){var n={fuelDate:function(t){e((function(e){return rr(rr({},e),{},{fuelDate:t})}))},fuelRun:function(t){e((function(e){return rr(rr({},e),{},{fuelRun:t})}))},fuelCost:function(t){e((function(e){var r=rr(rr({},e),{},{fuelCost:t});return+r.fuelPrice>0&&(r.fuelVolume="".concat(Math.round(+r.fuelCost/+r.fuelPrice*10)/10)),0==+r.fuelCost&&(r.fuelVolume=""),r}))},fuelPrice:function(t){e((function(e){var r=rr(rr({},e),{},{fuelPrice:t});return+r.fuelCost>0&&(r.fuelVolume="".concat(Math.round(+r.fuelCost/+r.fuelPrice*10)/10)),0==+r.fuelPrice&&(r.fuelVolume=""),r}))},fuelVolume:function(t){e((function(e){var r=rr(rr({},e),{},{fuelVolume:t});return+r.fuelPrice>0&&(r.fuelCost="".concat(Math.round(+r.fuelVolume*+r.fuelPrice))),0==+r.fuelVolume&&(r.fuelCost=""),r}))}},a=n[t];a&&a(r)}},finalCheck:function(e){return sr.apply(this,arguments)}})},{title:qr.SPARE,form:f.createElement(ct,{Form:function(e){var t=e.getValidate,r=e.finalCheck,n=(0,f.useContext)(Jt),a=n.spareState,c=n.updateSpareForm,i=(0,f.useState)(a),o=(0,O.Z)(i,2),s=o[0],l=o[1],p=(0,f.useContext)(Ft).closeForm,m=Ie(),d=t(l);return f.createElement(f.Fragment,null,f.createElement("div",{className:zt.popupContent},f.createElement("form",{className:zt.form},f.createElement("div",{className:"JbetMjXKThAMC5clo5Fc"},f.createElement(Pt,{validate:d,Control:f.createElement(Et,{name:"spareDate",label:"Дата",value:s.spareDate})}),f.createElement(Pt,{validate:d,Control:f.createElement(lr,{name:"spareTitle",label:"Наименование",value:s.spareTitle})}),f.createElement(Pt,{validate:d,Control:f.createElement(St,{InputComponent:kt,name:"sparePrice",label:"Цена",value:s.sparePrice,suffix:Xe.MONEY})})))),f.createElement(pt,{title:"Сохранить",auxStyles:zt.saveButton,clickHandler:(0,h.Z)(b().mark((function e(){return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r(s);case 2:if(!e.sent){e.next=7;break}return e.next=5,m(Fe(Er(Er({},t=s),{},{spareDate:u()(t.spareDate).toDate().valueOf(),spareTitle:t.spareTitle,sparePrice:Number(t.sparePrice)})));case 5:"fulfilled"===e.sent.meta.requestStatus&&(c(At),p());case 7:case"end":return e.stop()}var t}),e)})))}))},getValidate:function(e){return function(t,r){var n={spareDate:function(t){e((function(e){return yr(yr({},e),{},{spareDate:t})}))},spareTitle:function(t){e((function(e){return yr(yr({},e),{},{spareTitle:t})}))},sparePrice:function(t){e((function(e){return yr(yr({},e),{},{sparePrice:t})}))}},a=n[t];a&&a(r)}},finalCheck:function(e){return gr.apply(this,arguments)}})},{title:qr.SERVICE,form:f.createElement(ct,{Form:function(e){var t=e.getValidate,r=e.finalCheck,n=(0,f.useContext)(Jt),a=n.serviceState,c=n.updateServiceForm,i=n.repeatState,o=n.detailsState,s=n.updateRepeatForm,l=n.updateDetailsForm,p=(0,f.useContext)(Ft),m=p.showSubform,d=p.closeForm,v=(0,f.useState)(a),E=(0,O.Z)(v,2),y=E[0],S=E[1],g=Ie(),w=t(S),x=(0,f.useCallback)((function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return t&&m(e),t}),[m]);return f.createElement(f.Fragment,null,f.createElement("div",{className:zt.popupContent},f.createElement("form",{className:zt.form},f.createElement("div",{className:"DlEZuwOiDYn8je_abcWl"},f.createElement(Pt,{validate:w,Control:f.createElement(Et,{name:"serviceDate",label:"Дата",value:y.serviceDate})}),f.createElement(Pt,{validate:w,Control:f.createElement(lr,{name:"serviceDescription",label:"Описание",value:y.serviceDescription})}),f.createElement(Pt,{validate:w,Control:f.createElement(St,{InputComponent:kt,name:"serviceRun",label:"Пробег",value:y.serviceRun,suffix:Xe.RUN})}),f.createElement(Pt,{validate:w,Control:f.createElement(St,{InputComponent:kt,name:"serviceTotal",label:"Общая сумма",value:y.serviceTotal,suffix:Xe.MONEY,auxStyles:"kfrFJYUmEpmeBwhcgr_R"},f.createElement(wr,{auxClassNames:"HN04cvclKT9QvTZA79wr",handler:function(){return x(tn.detailsSubform)}}))}),f.createElement(Pt,{validate:w,Control:f.createElement(xr,{name:"serviceRepeat",label:"Повторять периодически",isChecked:y.serviceRepeat,auxStyles:"dMwccS2oJxG7iuuP5jVy",changeHandler:function(e){return x(tn.repeatSubform,e)}},f.createElement(wr,{auxClassNames:"jobnUbRMlYtCqSS2tUjk",handler:function(){return x(tn.repeatSubform)},disabled:!y.serviceRepeat}))})))),f.createElement(pt,{title:"Сохранить",auxStyles:zt.saveButton,clickHandler:(0,h.Z)(b().mark((function e(){var t,n,a,f;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=y,(o.services.length||o.spares.length)&&(t.serviceTotalDetails=o),e.next=4,r(t);case 4:if(!e.sent){e.next=24;break}return e.next=7,g(je((p=t,{serviceDate:u()(p.serviceDate).toDate().valueOf(),serviceDescription:p.serviceDescription,serviceRun:Number(p.serviceRun),serviceTotal:Number(p.serviceTotal),serviceTotalDetails:p.serviceTotalDetails})));case 7:if("fulfilled"!==(n=e.sent).meta.requestStatus){e.next=24;break}if(!i.repeatByRun&&!i.repeatByTime){e.next=20;break}if(a=n.payload.id,(f=kr(i)).serviceId=a,!i.repeatId){e.next=18;break}return e.next=16,g(ce({id:i.repeatId,formState:f}));case 16:e.next=20;break;case 18:return e.next=20,g(ae(f));case 20:s(_t),l(Ut),c(Yt),d();case 24:case"end":return e.stop()}var p}),e)})))}))},getValidate:function(e){return function(t,r){var n={serviceDate:function(t){e((function(e){return Rr(Rr({},e),{},{serviceDate:t})}))},serviceDescription:function(t){e((function(e){return Rr(Rr({},e),{},{serviceDescription:t})}))},serviceRun:function(t){e((function(e){return Rr(Rr({},e),{},{serviceRun:t})}))},serviceTotal:function(t){e((function(e){return Rr(Rr({},e),{},{serviceTotal:t})}))},serviceRepeat:function(t){e((function(e){return Rr(Rr({},e),{},{serviceRepeat:t})}))},serviceTotalDetails:function(t){e((function(e){return Rr(Rr({},e),{},{serviceTotalDetails:t})}))},serviceRepeatDetails:function(t){e((function(e){var r=Rr(Rr({},e),{},{serviceRepeatDetails:t});return t||(r.serviceRepeat=!1),r}))}},a=n[t];a&&a(r)}},finalCheck:function(e){return Pr.apply(this,arguments)}})},{title:qr.OTHER,form:f.createElement(ct,{Form:function(e){var t=e.getValidate,r=e.finalCheck,n=(0,f.useContext)(Jt),a=n.otherState,c=n.updateOtherForm,i=(0,f.useState)(a),o=(0,O.Z)(i,2),s=o[0],l=o[1],p=(0,f.useContext)(Ft).closeForm,m=Ie(),d=t(l);return f.createElement(f.Fragment,null,f.createElement("div",{className:zt.popupContent},f.createElement("form",{className:zt.form},f.createElement("div",{className:"dpO_lN_wmBh5B8SXqkij"},f.createElement(Pt,{validate:d,Control:f.createElement(Et,{name:"otherDate",label:"Дата",value:s.otherDate})}),f.createElement(Pt,{validate:d,Control:f.createElement(lr,{name:"otherTitle",label:"Наименование",value:s.otherTitle})}),f.createElement(Pt,{validate:d,Control:f.createElement(St,{InputComponent:kt,name:"otherPrice",label:"Цена",value:s.otherPrice,suffix:Xe.MONEY})})))),f.createElement(pt,{title:"Сохранить",auxStyles:zt.saveButton,clickHandler:(0,h.Z)(b().mark((function e(){return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r(s);case 2:if(!e.sent){e.next=7;break}return e.next=5,m(Ce(pr(pr({},t=s),{},{otherDate:u()(t.otherDate).toDate().valueOf(),otherTitle:t.otherTitle,otherPrice:Number(t.otherPrice)})));case 5:"fulfilled"===e.sent.meta.requestStatus&&(c(Ht),p());case 7:case"end":return e.stop()}var t}),e)})))}))},getValidate:function(e){return function(t,r){var n={otherDate:function(t){e((function(e){return vr(vr({},e),{},{otherDate:t})}))},otherTitle:function(t){e((function(e){return vr(vr({},e),{},{otherTitle:t})}))},otherPrice:function(t){e((function(e){return vr(vr({},e),{},{otherPrice:t})}))}},a=n[t];a&&a(r)}},finalCheck:function(e){return dr.apply(this,arguments)}})}],tn={repeatSubform:{title:qr.REPEAT,form:f.createElement(ct,{Form:function(e){var t=e.getValidate,r=e.finalCheck,n=(0,f.useContext)(Jt),a=n.repeatState,c=n.updateRepeatForm,u=(0,f.useContext)(Ft).closeSubform,i=(0,f.useState)(a),o=(0,O.Z)(i,2),s=o[0],l=t(o[1]);return f.createElement(f.Fragment,null,f.createElement("div",{className:zt.popupContent},f.createElement("form",{className:zt.form},f.createElement("div",{className:"oHQ2mkxPmKc1mDyzn5Gg"},f.createElement(Tr,null,f.createElement(Pt,{validate:l,Control:f.createElement(xr,{name:"repeatByRun",label:"по пробегу",isChecked:s.repeatByRun})}),f.createElement(Pt,{validate:l,Control:f.createElement(St,{InputComponent:kt,name:"repeatingRun",label:"Пробег",value:s.repeatingRun,suffix:Xe.RUN,disabled:!s.repeatByRun})})),f.createElement(Tr,null,f.createElement(Pt,{validate:l,Control:f.createElement(xr,{name:"repeatByTime",label:"по времени",isChecked:s.repeatByTime})}),f.createElement(Tr,{horizontal:!0},f.createElement(Pt,{validate:l,Control:f.createElement(St,{InputComponent:kt,name:"repeatingTime",label:"Время",value:s.repeatingTime,disabled:!s.repeatByTime,suffix:yt(s.repeatingTime,s.repeatTimeSlot)})}),f.createElement(Pt,{validate:l,Control:f.createElement(jr,{name:"repeatTimeSlot",options:qe,selected:s.repeatTimeSlot,disabled:!s.repeatByTime})})))))),f.createElement(pt,{title:"Сохранить",auxStyles:zt.saveButton,clickHandler:(0,h.Z)(b().mark((function e(){return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r(s);case 2:if(!e.sent){e.next=5;break}c(s),u();case 5:case"end":return e.stop()}}),e)})))}))},getValidate:function(e){return function(t,r){var n={repeatingRun:function(t){e((function(e){return Mr(Mr({},e),{},{repeatingRun:t})}))},repeatingTime:function(t){e((function(e){return Mr(Mr({},e),{},{repeatingTime:t})}))},repeatByRun:function(t){e((function(e){var r=Mr(Mr({},e),{},{repeatByRun:t});return r.repeatByTime||(r.repeatingRun=""),r}))},repeatByTime:function(t){e((function(e){var r=Mr(Mr({},e),{},{repeatByTime:t});return r.repeatByTime||(r.repeatingTime=""),r}))},repeatTimeSlot:function(t){e((function(e){return Mr(Mr({},e),{},{repeatTimeSlot:t})}))}},a=n[t];a&&a(r)}},finalCheck:function(e){return Zr.apply(this,arguments)}})},detailsSubform:{title:qr.DETAILS,form:f.createElement(ct,{Form:function(e){var t,r,n,a,c=e.getValidate,u=e.finalCheck,i=(0,f.useContext)(Jt),o=i.detailsState,s=i.updateDetailsForm,l=(0,f.useContext)(Ft).closeSubform,p=(0,f.useState)(o),m=(0,O.Z)(p,2),d=m[0],v=m[1],E=(0,f.useState)(Xr[0].id),y=(0,O.Z)(E,2),S=y[0],g=y[1],w=c(v),x=function(e,t){return"".concat(t,"-").concat(e)};return f.createElement(f.Fragment,null,f.createElement("div",{className:zt.popupContent},f.createElement("form",{className:zt.form},f.createElement("div",{className:"FKCIDvhS4dpDatKOiRGU"},f.createElement(Kr,{name:"service-details",tabInfo:Xr,changedHandler:g,themeOnLight:!0},f.createElement(Ur,{headers:["Название","Цена"],addRowHandler:function(){return w("".concat(S,"-add"),"")}},(t=(0,f.useState)(d.services),r=(0,O.Z)(t,2),n=r[0],a=r[1],(0,f.useEffect)((function(){a(S===Xr[0].id?d.services:d.spares)}),[S]),n).map((function(e,t){return f.createElement(Lr,{key:e.id,deleteHandler:function(){return function(e){return w("".concat(S,"-delete-").concat(e),"")}(t)}},f.createElement(Pt,{validate:w,Control:f.createElement(lr,{name:"".concat(x("title",S),"-").concat(t),value:e.title,label:"",auxStyles:it()(Yr,Ir)})}),f.createElement(Pt,{validate:w,Control:f.createElement(St,{InputComponent:kt,suffix:Xe.MONEY,name:"".concat(x("price",S),"-").concat(t),value:"".concat(e.price),label:"",auxStyles:it()(Hr,Ir)})}))}))))))),f.createElement(pt,{title:"Сохранить",auxStyles:zt.saveButton,clickHandler:(0,h.Z)(b().mark((function e(){return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u(d);case 2:if(!e.sent){e.next=5;break}s(d),l();case 5:case"end":return e.stop()}}),e)})))}))},getValidate:function(e){return function(t,r){e((function(e){var n=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Jr(Object(r),!0).forEach((function(t){(0,E.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Jr(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},e),a=function(e){var t=e.split("-");return{section:t[0],key:t[1],index:Number(t[2])}}(t),c=a.section,u=a.key,i=a.index;switch(u){case"add":n[c].push({id:Math.floor(1e9*Math.random()),title:"",price:0});break;case"delete":n[c].splice(i,1);break;case"price":n[c][i][u]=Number(r);break;case"title":n[c][i][u]=r}return n}))}},finalCheck:function(e){return Qr.apply(this,arguments)}})}};function rn(e){return"run"in e}function nn(e){return"time"in e}function an(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function cn(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?an(Object(r),!0).forEach((function(t){(0,E.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):an(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}!function(e){e[e.NORMAL=0]="NORMAL",e[e.NEARDUE=1]="NEARDUE",e[e.OVERDUED=2]="OVERDUED"}($r||($r={}));var un,on=function(){function e(t){return(0,Ae.Z)(this,e),e._instance||(e._instance=this),this._reminders=[],this.onUpdateCallback=null,this._store=t,this.storeDispatch=t.dispatch,e._instance}var t,r,a;return(0,Ye.Z)(e,[{key:"reminders",get:function(){return this._reminders}},{key:"init",value:(a=(0,h.Z)(b().mark((function e(){var t;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.storeDispatch(ee()),e.next=3,P(n.REPEAT);case 3:return t=e.sent,this.storeDispatch(te(t)),e.next=7,this.setReminders();case 7:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"clearReminders",value:function(){this._reminders=[],this.onUpdateCallback&&this.onUpdateCallback()}},{key:"setReminders",value:(r=(0,h.Z)(b().mark((function e(){var t,r,a,c,i,o,s,l;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(l=function(){return(l=(0,h.Z)(b().mark((function e(t,r){var a,c,u,i,o,s,l;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.serviceRun,e.next=3,Promise.all([U(n.SERVICE),U(n.FUEL)]);case 3:return c=e.sent,u=(0,O.Z)(c,2),i=u[0],o=u[1],s=Math.max(o.fuelRun||0,i.serviceRun||0),l=r-(s-a),e.abrupt("return",l);case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)},s=function(e,t){return l.apply(this,arguments)},o=function(){return(o=(0,h.Z)(b().mark((function e(t,r,n){var a,c,i,o;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.serviceDate,c=u()().valueOf(),i=u().duration(r,n).asMilliseconds(),o=u().duration(i-(c-a)).asMilliseconds(),e.abrupt("return",o);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)},i=function(e,t,r){return o.apply(this,arguments)},c=function(e,t,r){return e<=0?$r.OVERDUED:e<=t&&r===$r.NORMAL?$r.NEARDUE:r},a=function(){return(a=(0,h.Z)(b().mark((function e(t){var r,a,o,l;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,A(n.SERVICE,t.serviceId);case 2:if(r=e.sent,a={id:t.id,serviceId:t.serviceId,title:r.serviceDescription,urgency:$r.NORMAL,trigger:{},initConditions:{run:t.repeatingRun,time:t.repeatingTime,timeUnits:t.repeatTimeSlot}},!t.repeatByRun){e.next=10;break}return e.next=7,s(r,t.repeatingRun);case 7:o=e.sent,a.urgency=c(o,100,a.urgency),a.trigger=cn(cn({},a.trigger),{},{run:Math.abs(o)});case 10:if(!t.repeatByTime){e.next=16;break}return e.next=13,i(r,t.repeatingTime,t.repeatTimeSlot);case 13:l=e.sent,a.urgency=c(u().duration(l).asDays(),7,a.urgency),a.trigger=cn(cn({},a.trigger),{},{time:{interval:Math.round(u().duration(Math.abs(l)).as(t.repeatTimeSlot)),unit:t.repeatTimeSlot}});case 16:return e.abrupt("return",a);case 17:case"end":return e.stop()}}),e)})))).apply(this,arguments)},r=function(e){return a.apply(this,arguments)},this._reminders=[],(t=this._store.getState().repeat).length){e.next=12;break}return this._reminders=[],e.abrupt("return");case 12:return e.next=14,Promise.all(t.map(function(){var e=(0,h.Z)(b().mark((function e(t){return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 14:this._reminders=e.sent,this.onUpdateCallback&&this.onUpdateCallback();case 16:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"setShowFormAction",value:function(e){var t=en.find((function(e){return e.title===qr.SERVICE}));t&&(this.showServiceForm=function(){return e(t)})}},{key:"setFormsDataActions",value:function(e,t,r){this.updateServiceForm=e,this.updateRepeatForm=t,this.updateDetailsForm=r}},{key:"editServiceWithReminder",value:(t=(0,h.Z)(b().mark((function e(t){var r,a,c;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,A(n.SERVICE,t.serviceId);case 2:r=e.sent,a={repeatId:t.id,repeatingRun:rn(t.trigger)?"".concat(t.initConditions.run):"",repeatingTime:nn(t.trigger)?"".concat(t.initConditions.time):"",repeatByRun:"run"in t.trigger,repeatByTime:"time"in t.trigger,repeatTimeSlot:t.initConditions.timeUnits},c={serviceDate:u()().format("YYYY-MM-DD"),serviceDescription:r.serviceDescription,serviceRun:"",serviceTotal:"",serviceRepeat:!0,serviceTotalDetails:r.serviceTotalDetails,serviceRepeatDetails:a},this.updateServiceForm&&this.updateServiceForm(c),this.updateRepeatForm&&this.updateRepeatForm(a),this.showServiceForm&&this.showServiceForm();case 8:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"setOnUpdateCallback",value:function(e){this.onUpdateCallback=e}}]),e}(),sn="car_title";var ln=function(){function e(){return(0,Ae.Z)(this,e),(0,E.Z)(this,"_title",""),(0,E.Z)(this,"callback",null),e._instance||(e._instance=this),e._instance}return(0,Ye.Z)(e,[{key:"title",get:function(){return this._title}},{key:"init",value:function(){(function(){if(!function(){try{var e=window.localStorage,t="__storage_test__";return e.setItem(t,t),e.removeItem(t),!0}catch(e){return!1}}())throw new Error("LocalStore unavailable");un=window.localStorage})(),this._title=un.getItem(sn)||""}},{key:"clearTitle",value:function(){un.removeItem(sn),this._title="",this.callback&&this.callback()}},{key:"updateTitle",value:function(e){this._title=e,function(e){un.setItem(sn,e)}(this._title),this.callback&&this.callback()}},{key:"setOnUpdateCallback",value:function(e){this.callback=e}}]),e}(),fn=function(){function e(){return(0,Ae.Z)(this,e),e._instance||(e._instance=this),this.updateFuelForm=function(){},this.updateServiceForm=function(){},this.updateSpareForm=function(){},this.updateOtherForm=function(){},this.updateRepeatForm=function(){},this.updateDetailsForm=function(){},this.showForm=function(){},e._instance}return(0,Ye.Z)(e,[{key:"setFormsDataActions",value:function(e){this.updateFuelForm=e.updateFuelForm,this.updateServiceForm=e.updateServiceForm,this.updateSpareForm=e.updateSpareForm,this.updateOtherForm=e.updateOtherForm,this.updateRepeatForm=e.updateRepeatForm,this.updateDetailsForm=e.updateDetailsForm}},{key:"setShowFormAction",value:function(e){this.showForm=function(t){var r=en.find((function(e){return e.title===t}));r&&e(r)}}},{key:"editForm",value:function(e){var t=this;switch(!0){case Be(e):var r=e;this.updateFuelForm({id:e.id,fuelDate:u()(r.fuelDate).format("YYYY-MM-DD"),fuelRun:String(r.fuelRun),fuelCost:String(r.fuelCost),fuelPrice:String(r.fuelPrice),fuelVolume:String(r.fuelVolume)}),this.showForm(qr.FUEL);break;case Ge(e):var n=e;this.updateSpareForm({id:e.id,spareDate:u()(n.spareDate).format("YYYY-MM-DD"),spareTitle:n.spareTitle,sparePrice:String(n.sparePrice)}),this.showForm(qr.SPARE);break;case Ve(e):var a=e;this.updateOtherForm({id:e.id,otherDate:u()(a.otherDate).format("YYYY-MM-DD"),otherTitle:a.otherTitle,otherPrice:String(a.otherPrice)}),this.showForm(qr.OTHER);break;case We(e):var c=e;Z(e.id).then((function(r){var n=r?{repeatId:r.id,repeatingRun:String(r.repeatingRun),repeatingTime:String(r.repeatingTime),repeatByRun:r.repeatByRun,repeatByTime:r.repeatByTime,repeatTimeSlot:r.repeatTimeSlot}:null;n&&t.updateRepeatForm(n),t.updateServiceForm({id:e.id,serviceDate:u()(c.serviceDate).format("YYYY-MM-DD"),serviceDescription:c.serviceDescription,serviceRun:String(c.serviceRun),serviceTotal:String(c.serviceTotal),serviceRepeat:!!n,serviceTotalDetails:c.serviceTotalDetails,serviceRepeatDetails:n||{}}),t.showForm(qr.SERVICE)}))}}},{key:"deleteRow",value:function(e){if(window.confirm("Удалить запись?"))switch(!0){case Be(e):J(n.FUEL,e.id);break;case Ge(e):J(n.SPARE,e.id);break;case Ve(e):J(n.OTHER,e.id);break;case We(e):J(n.SERVICE,e.id),Z(e.id).then((function(e){e&&J(n.REPEAT,e.id)}))}}}]),e}();function pn(){return(pn=(0,h.Z)(b().mark((function e(){var t;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!("serviceWorker"in navigator)){e.next=11;break}return e.prev=1,e.next=4,navigator.serviceWorker.register("./sw.js");case 4:(t=e.sent).installing?console.log("Service worker installing"):t.waiting?console.log("Service worker installed"):t.active&&console.log("Service worker active"),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),console.error("Registration failed with ".concat(e.t0));case 11:case"end":return e.stop()}}),e,null,[[1,8]])})))).apply(this,arguments)}var mn;function dn(e){var t=e.isClosed,r=e.children;return f.createElement("section",{className:it()("KIGBMrbYu6IB3fjytqmM",(0,E.Z)({},"aWeYr15TJGiwyIRKH2RQ",t))},f.createElement("div",{className:it()("HX38XviFFmdvcQGYWPw7")},r))}function hn(e){var t=e.isClosed,r=e.currentTitle,n=e.titleUpdatedHandler,a=e.destroyDataHandler;return f.createElement(dn,{isClosed:t},f.createElement("div",{className:"TpCF3ezIfSBz6GEjApWz"},f.createElement("h2",{className:it()(st,"bRvSMrbtNs9fgAch8W8t")},"Марка машины"),f.createElement(lr,{name:"car-name",value:r,label:"",auxStyles:"GPdjCcTXUpoYfAuDyHKu",blurHandler:function(e){return n(e.target.value)}})),f.createElement(pt,{title:"Удалить данные",auxStyles:"vgzi32a9xQCrzKrzO0Sj",clickHandler:a}))}!function(e){e[e.TILES=0]="TILES",e[e.STATS=1]="STATS"}(mn||(mn={}));var vn={currentPage:mn.TILES,switchToStat:function(){},switchToTiles:function(){}},bn=(0,f.createContext)(vn);function En(e){var t=e.children,r=(0,f.useState)(vn.currentPage),n=(0,O.Z)(r,2),a=n[0],c=n[1],u=(0,f.useCallback)((function(){return c(mn.STATS)}),[]),i=(0,f.useCallback)((function(){return c(mn.TILES)}),[]);return f.createElement(bn.Provider,{value:{currentPage:a,switchToStat:u,switchToTiles:i}},t)}var On="ruov_B57Kz7JHpeovnj6",yn="gBI0OKnHIPUFI9yNvcry";function Sn(e){var t=e.controller,r=e.burgerHandler,n=void 0===r?function(){}:r,a=e.onReturnHandler,c=void 0===a?function(){}:a,u=e.onDeleteData,i=(0,f.useState)(!0),o=(0,O.Z)(i,2),s=o[0],l=o[1],p=(0,f.useContext)(bn),m=p.currentPage,d=p.switchToTiles,h=(0,f.useState)(it()(On,yn)),v=(0,O.Z)(h,2),b=v[0],E=v[1];(0,f.useEffect)((function(){E(it()(On,s?yn:"Xl3r2JRKK4pbCxpI8PPm"))}),[s]);var y=(0,f.useState)(t.title),S=(0,O.Z)(y,2),g=S[0],w=S[1],x=(0,f.useCallback)((function(){return w(t.title)}),[]);return(0,f.useEffect)((function(){return t.setOnUpdateCallback(x),function(){return t.setOnUpdateCallback(null)}}),[]),f.createElement("header",{className:"cnU0yTmUWDLmhj8iiYW5"},f.createElement("div",{className:"_LyXCg4Y3RV0PRrCgTE1"},f.createElement("div",{className:"BBzLp7XHhxWsvTCW6X4F"},f.createElement("div",{className:"dKLcmJxnlJr5MFKDxHAm"},m===mn.STATS&&f.createElement(wr,{label:"Return to main screen",auxClassNames:"".concat("M3JkyGir1da8bCNE9qJ7"),handler:function(e){c(e),d()}}),f.createElement("h2",{className:it()("w3J9g4nCRwqhTgAeILyH",ot,ft)},g)),f.createElement(wr,{label:"Burger button",auxClassNames:b,handler:function(e){n(e),l((function(e){return!e}))}}))),f.createElement(hn,{isClosed:s,currentTitle:s?"":g,titleUpdatedHandler:function(e){return t.updateTitle(e)},destroyDataHandler:function(){u(),l(!0)}}))}var gn=r(91),wn=r(257);function xn(e){var t="";switch(e.unit){case le.DAY:t="iU0O7QLT2jsJR0t3ZQYF";break;case le.MONTH:t="YQUMWUZy1nqNUoEGQB5c";break;case le.YEAR:switch(function(e){var t=+e.interval.toString().slice(-1);switch(!0){case 1==t:return Ke.SINGLE;case t>=2&&t<=4:return Ke.MULTIPLE;case t>=5:return Ke.LONG}return Ke.LONG}(e)){case Ke.SINGLE:t="Ax0JhHM4QlX35uKynEom";break;case Ke.MULTIPLE:t="rLDr4o9pmEOjJrKGZcW2";break;case Ke.LONG:t="kceScQuZZFJpdNCdMw2j"}}return t}function kn(e){var t=e.title,r=e.trigger,n=e.urgency,a=e.clickHandler;return f.createElement("div",{className:"JZaOmhZ_TYqcITE0iMYe",onClick:a},f.createElement("p",{className:it()(st,ft)},t),f.createElement("div",{className:it()("qrBc2QwZ907_l8oztWCH",n===$r.OVERDUED&&"T6vOEbuK7AChDCbSFCGP")},rn(r)&&f.createElement("p",{className:"kDRwLV2jFj9D2UhkGHEe"},r.run),nn(r)&&f.createElement("p",{className:it()("UZqrVcEC4HYKsqmpjMlS",xn(r.time))},r.time.interval)))}var Dn="nAAt_mOEqlBxSDfpnq32";function Rn(e){var t,r=e.remindersController,n=(0,f.useContext)(Ft).showForm,a=(0,f.useContext)(Jt),c=a.updateServiceForm,u=a.updateRepeatForm,i=a.updateDetailsForm;r.setShowFormAction(n),r.setFormsDataActions(c,u,i);var o=(0,f.useState)(r.reminders),s=(0,O.Z)(o,2),l=s[0],p=s[1],m=(0,f.useCallback)((function(){return p(r.reminders)}),[]);(0,f.useEffect)((function(){return r.setOnUpdateCallback(m),function(){return r.setOnUpdateCallback(null)}}),[]);var d=(t={},(0,E.Z)(t,$r.NORMAL,Dn),(0,E.Z)(t,$r.NEARDUE,"lt9hqt060NEGdSZoQ5OP"),(0,E.Z)(t,$r.OVERDUED,"c8PYBnHTBVCAhAj5N3Yw"),t),h=(0,f.useState)(Dn),v=(0,O.Z)(h,2),b=v[0],y=v[1];return(0,f.useEffect)((function(){l.length&&y(d[l[0].urgency])}),[l]),0===l.length?f.createElement(f.Fragment,null):f.createElement("section",{className:it()("xPmiWDonSAxlF3qY1T_n",b)},f.createElement(gn.tq,{slidesPerView:1,modules:[wn.tl],pagination:{el:".swiper-pagination",type:"bullets"}},l.map((function(e){return f.createElement(gn.o5,{key:e.id},(function(t){var n=t.isActive;return(0,f.useEffect)((function(){n&&y(d[e.urgency])}),[n]),f.createElement(kn,{title:e.title,trigger:e.trigger,urgency:e.urgency,clickHandler:function(){return r.editServiceWithReminder(e)}})}))})),f.createElement("div",{className:"swiper-pagination"})))}var Cn="sEXVVC9zII_COJ82w2Lj",Pn="mdFMHeIso4sBaJ49X7_B",Tn="kWXeBYDu9hWDu2FQsXgz",jn="iPDYuS4yCr4fSa5Fw6tg",Nn="x33bGyXZ0epwt1252UkT";function Zn(e){var t=e.title,r=e.units,n=e.value;return f.createElement("div",{className:it()(Pn,Nn)},f.createElement("h3",{className:it()(st,Tn)},t," ",f.createElement("br",null),f.createElement("span",{className:it()(lt,jn)},r)),f.createElement("div",{className:it()("PW7fwoVPXzGAplYoZO06","z0bddPUW7PV0FbA7Sb2Q")},n))}function Fn(e){var t=e.value,r=e.wide,n=it()("GDCxSFaOTxx8RJ7Bk4w2",(0,E.Z)({},"apkD_zCEY1FkTB4hIOX2",r));return f.createElement("div",{className:n,style:{height:"".concat(t,"%")}})}function Mn(e){var t,r,n,a,c=e.chartData,u=(r=(t=c).filter((function(e){return 0!==e})),n=Math.min.apply(Math,(0,He.Z)(r)),a=Math.max.apply(Math,(0,He.Z)(r))-n,t.map((function(e){if(0===e)return 2;var t=70*(e-n)/a;return 30+Math.round(t)}))),i=3===c.length;return f.createElement("div",{className:it()(Pn,"lywuM7_58g98Umu6xt4D")},f.createElement("div",{className:it()("F11eEZaEUeYyUyhrr0Ze")},f.createElement("div",{className:it()("oYRktFsd5t_2Kjh5nX_8")},u.map((function(e,t){return f.createElement(Fn,{key:t,value:e,wide:i})})))))}function In(e){var t=e.title,r=e.units,n=e.value,a=e.chartData,c=(0,f.useContext)(bn).switchToStat;return f.createElement("div",{className:Cn,onClick:c},f.createElement(Zn,{title:t,units:r,value:n}),f.createElement(Mn,{chartData:a}))}var An="EmqGv3WFsTnDij_ZE0JT";function Yn(e){var t=e.tilesController,r=(0,f.useContext)(Wr).id,n=(0,f.useState)(t.tiles),a=(0,O.Z)(n,2),c=a[0],u=a[1],i=(0,f.useCallback)((function(){return u(t.tiles)}),[]);return(0,f.useEffect)((function(){return t.setOnUpdateCallback(i),function(){return t.setOnUpdateCallback(null)}}),[]),(0,f.useEffect)((function(){return t.setTimeInterval(r)}),[r]),f.createElement("section",{className:An},c.map((function(e){return f.createElement(In,{key:e.title,title:e.title,units:e.units,value:e.value,chartData:e.chartData})})))}function Hn(e){var t=e.title,r=e.clickHandler;return f.createElement("div",{className:"TnXh6o7WkV3fIeRjUrAK",onClick:function(){return r()}},t)}function _n(e){var t=e.forms,r=e.isOpened,n=(0,f.useContext)(Ft),a=n.toggleRollup,c=n.showForm;return f.createElement("div",{className:it()("Kt5aZm9GGNghvuuJAo6E",(0,E.Z)({},"bMd4uh_ifHRAuHLpdFFT",r))},f.createElement("div",{className:"gjPR0Y8sjHulv1SW3ifB"},f.createElement("div",{className:"UyM66w7SjHgdR1pEPGw5"},t.map((function(e,t){return f.createElement(Hn,{key:t,title:e.title,clickHandler:function(){a(),c({title:e.title,form:e.form})}})})))))}function Un(e){var t=e.title,r=e.forms,n=e.rollupOpened,a=(0,f.useContext)(Ft).toggleRollup,c=it()("Yhv2DWHUkdXnz8y4oJb6",(0,E.Z)({},"lBrxIeSAn3MDyvE5ZHNX",n));return f.createElement("div",{className:"nybUweq5dPcSszoz2YZF"},f.createElement(pt,{title:t,auxStyles:c,clickHandler:a}),f.createElement(_n,{forms:r,isOpened:n}))}function Ln(e){var t,r=e.title,n=e.small,a=void 0!==n&&n,c=e.inactive,u=void 0!==c&&c,i=e.form,o=e.closeAction,s=!!i,l=it()(zt.container,(0,E.Z)({},zt.containerOpened,s));return f.createElement("section",{className:it()(zt.popup,(t={},(0,E.Z)(t,zt.popupSmall,a),(0,E.Z)(t,zt.inactive,u),(0,E.Z)(t,zt.popupOpened,s),t))},f.createElement("div",{className:l},f.createElement("header",{className:zt.header},f.createElement("h3",{className:it()(ot,ft)},r),f.createElement(wr,{label:"Закрыть попап",auxClassNames:zt.close,handler:function(){return o()}})),i))}function Bn(){var e,t,r,n,a=(0,f.useContext)(Ft),c=a.state,u=a.closeForm,i=a.closeSubform,o=!!c.currentSubform;return f.createElement(f.Fragment,null,f.createElement(Ln,{title:null===(e=c.currentForm)||void 0===e?void 0:e.title,form:null===(t=c.currentForm)||void 0===t?void 0:t.form,inactive:o,closeAction:u}),f.createElement(Ln,{title:null===(r=c.currentSubform)||void 0===r?void 0:r.title,form:null===(n=c.currentSubform)||void 0===n?void 0:n.form,closeAction:i,small:!0}))}function Vn(e){var t=e.forms,r=(0,f.useContext)(Ft).state;return f.createElement(f.Fragment,null,f.createElement(Un,{title:"Потратить деньги",forms:t,rollupOpened:r.rollupOpened}),f.createElement(Bn,null))}function Gn(){return f.createElement(qt,null,f.createElement(Mt,null,f.createElement(Rn,{remindersController:xa}),f.createElement(Kr,{name:"time-interval",tabInfo:ze},f.createElement(Yn,{tilesController:wa})),f.createElement(Vn,{forms:en})))}function Wn(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Kn(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Wn(Object(r),!0).forEach((function(t){(0,E.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Wn(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Xn={title:"Пробег",units:"км.",chartData:[]},Jn={title:"Расход топлива",units:"л./км.",chartData:[]},qn={title:"Затраты",units:"руб.",chartData:[]};function zn(e,t){var r=t.map((function(e){return e.value}));switch(!0){case r.length>12:r=r.slice(-12);break;case r.length<12:r=new Array(12-r.length).fill(0).concat(r)}return Kn(Kn({},e),{},{chartData:r})}function Qn(e){var t=e.title,r=e.units;return f.createElement("div",{className:it()(Pn,Nn)},f.createElement("h3",{className:it()(st,Tn)},t," ",f.createElement("span",{className:it()(lt,jn)},r)))}function $n(e){var t=e.title,r=e.units,n=e.chartData;return f.createElement("div",{className:it()(Cn,"_Fk5DPSTGRvdEELM9mf7")},f.createElement(Qn,{title:t,units:r}),f.createElement(Mn,{chartData:n}))}function ea(){var e=function(e){var t=(0,f.useState)([Xn,Jn,qn]),r=(0,O.Z)(t,2),n=r[0],a=r[1];return(0,f.useEffect)((function(){return a([zn(Xn,e.runStat),zn(Jn,e.fuelStat),zn(qn,e.expenceStat)])}),[e]),n}((0,m.v9)((function(e){return e.stat})));return f.createElement("section",{className:it()(An,"hpbb6afF4NHx6NA1XtUA")},e.map((function(e){return f.createElement($n,{key:e.title,title:e.title,units:e.units,chartData:e.chartData})})))}function ta(e,t,r,n,a){var c=e.find((function(e){return e.timestamp===t}));a.rows.push({title:r,value:c?"".concat(c.value," ").concat(n):null})}function ra(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=[],n=new Map;return e.forEach((function(e){var t=u()(e.timestamp).startOf("year").valueOf(),r=n.get(t)||[];r.push(e.value),n.set(t,r)})),n.forEach((function(e,n){return r.push({timestamp:n,value:t?Math.round(e.reduce((function(e,t){return e+t}),0)/e.length*10)/10:e.reduce((function(e,t){return e+t}),0)})})),r}var na="wDKDyN71OhkZcFd2OOYW";function aa(e){var t=e.header;return f.createElement("div",{className:it()(na)},f.createElement("h3",{className:"PQRbF9Ci15UeN7DyXfuc"},t))}function ca(e){var t=e.title,r=e.value,n=e.clickHandler;return f.createElement("div",{className:na,onClick:n},f.createElement("p",{className:it()("EMIFtsyK7XAmJgiArELg",ft)},t),f.createElement("p",{className:"EZtCPYcRm6Mpp5InDAl8"},r||"—"))}function ua(e){var t=e.deletable,r=e.onDelete,n=e.children;return t?f.createElement(f.Fragment,null,f.createElement(Lr,{deleteHandler:r},n)):f.createElement(f.Fragment,null,n)}function ia(e){var t=e.header,r=e.rows,n=e.slotEditHandler,a=e.slotDeleteHandler,c=e.rowDeletable;return f.createElement("div",{className:"l2AmDyXyqgMIBxKUIX2S"},f.createElement(aa,{header:t}),r.map((function(e,t){var r;return f.createElement(ua,{deletable:c,key:"".concat(e.title,"-").concat(null===(r=e.aux)||void 0===r?void 0:r.id)||t,onDelete:function(){return e.aux&&a(e.aux)}},f.createElement(ca,{title:e.title,value:e.value,clickHandler:function(){return e.aux&&n(e.aux)}}))})))}function oa(e){var t=e.slots,r=e.slotEditHandler,n=void 0===r?function(){}:r,a=e.slotDeleteHandler,c=void 0===a?function(){}:a,u=e.rowsDeletable,i=void 0!==u&&u;return f.createElement("section",{className:"zZ9MCIh_H5Fm1Cn0zp0d"},t.map((function(e){return f.createElement(ia,{key:e.header,header:e.header,rows:e.rows,slotEditHandler:n,slotDeleteHandler:c,rowDeletable:i})})))}function sa(){var e,t,r,n,a,c,i=(e=(0,m.v9)((function(e){return e.stat})),t=(0,f.useContext)(Wr),r=(0,f.useState)([]),n=(0,O.Z)(r,2),a=n[0],c=n[1],(0,f.useEffect)((function(){var r=e;t.id===fe.YEAR&&(r={fuelStat:ra(e.fuelStat,!0),runStat:ra(e.runStat),expenceStat:ra(e.expenceStat)}),c(function(e,t){var r=[];return function(e){var t=[].concat((0,He.Z)(e.expenceStat),(0,He.Z)(e.fuelStat),(0,He.Z)(e.runStat)).map((function(e){return e.timestamp})).sort((function(e,t){return t-e}));return new Set(t)}(e).forEach((function(n){var a={header:"",rows:[]};a.header=t.id===fe.YEAR?u()(n).format("YYYY год"):u()(n).format("MMMM YYYY года"),ta(e.runStat,n,"Пробег","км.",a),ta(e.fuelStat,n,"Расход топлива","л./100 км.",a),ta(e.expenceStat,n,"Затраты","руб.",a),r.push(a)})),r}(r,t))}),[e,t]),a);return i.length>0?f.createElement(oa,{slots:i}):null}var la=Object.values(n).filter((function(e){return"repeat"!==e}));function fa(e){return pa.apply(this,arguments)}function pa(){return(pa=(0,h.Z)(b().mark((function e(t){var r;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=la.map((function(e){return j(e,t,t)})),e.next=3,Promise.all(r);case 3:return e.abrupt("return",e.sent.flat());case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ma(e){return da.apply(this,arguments)}function da(){return da=(0,h.Z)(b().mark((function e(t){var r,n,a,c,u,i;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([Promise.all(t.map((function(e){return B(e)}))),Promise.all(t.map((function(e){return G(e)})))]);case 2:return r=e.sent,n=(0,O.Z)(r,2),a=n[0],c=n[1],u=Math.min.apply(Math,(0,He.Z)(a)),i=Math.max.apply(Math,(0,He.Z)(c)),e.abrupt("return",{newestDate:i,oldestDate:u});case 9:case"end":return e.stop()}}),e)}))),da.apply(this,arguments)}function ha(e,t){var r={header:u()(e).format("DD MMMM YYYY года"),rows:[]};return t.forEach((function(e){var t={title:"",value:null,aux:e};switch(!0){case Be(e):t.title="Топливо",t.value="".concat(e.fuelCost," руб.");break;case We(e):t.title=e.serviceDescription,t.value="".concat(e.serviceTotal," руб.");break;case Ge(e):t.title=e.spareTitle,t.value="".concat(e.sparePrice," руб.");break;case Ve(e):t.title=e.otherTitle,t.value="".concat(e.otherPrice," руб.")}r.rows.push(t)})),r}function va(){var e=(0,f.useContext)(Ft).showForm,t=(0,f.useContext)(Jt);Da.setShowFormAction(e),Da.setFormsDataActions(t);var r=function(){var e=(0,f.useState)([]),t=(0,O.Z)(e,2),r=t[0],n=t[1],a=(0,f.useState)(!1),c=(0,O.Z)(a,2),i=c[0],o=c[1];return(0,f.useEffect)((function(){function e(){return(e=(0,h.Z)(b().mark((function e(){var t,r,a,c,s,l,f;return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[],e.next=3,ma(la);case 3:r=e.sent,a=r.newestDate,c=r.oldestDate,s=a;case 7:if(!(s>=c)){e.next=15;break}return e.next=10,fa(s);case 10:(l=e.sent).length>0&&(f=ha(s,l),t.push(f)),s=u()(s).subtract(1,"day").valueOf();case 13:e.next=7;break;case 15:n(t),i&&o(!1);case 17:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[i]),{data:r,updateData:function(){o(!0)}}}(),n=r.data,a=r.updateData;return f.createElement(oa,{slots:n,rowsDeletable:!0,slotEditHandler:function(e){Da.editForm(e),a()},slotDeleteHandler:function(e){Da.deleteRow(e),a()}})}var ba=[{id:pe.STAT,title:"Статистика"},{id:pe.LIST,title:"Затраты списком"}];function Ea(){return f.createElement(f.Fragment,null,f.createElement(Kr,{name:"tab-stat",tabInfo:ba},f.createElement(Oa,null)))}function Oa(){return(0,f.useContext)(Wr).id===pe.STAT?f.createElement(f.Fragment,null,f.createElement(ea,null),f.createElement(Kr,{name:"time-interval",tabInfo:ze},f.createElement(sa,null))):f.createElement(f.Fragment,null,f.createElement(qt,null,f.createElement(Mt,null,f.createElement(va,null),f.createElement(Bn,null))))}function ya(){var e=(0,f.useContext)(bn).currentPage,t=e===mn.TILES?"AuriZ087RfES7F6NC5EN":"mwY4ekOdmqqN8LVCXSoO";return f.createElement("main",null,f.createElement("div",{className:t},e===mn.TILES?f.createElement(Gn,null):f.createElement(Ea,null)))}function Sa(){window.confirm("Удалить все данные?\n  Эта операция необратима!")&&(ka.clearTitle(),wa.clearTiles(),xa.clearReminders(),function(){x.apply(this,arguments)}())}function ga(){return f.createElement(f.Fragment,null,f.createElement("h1",{className:Br},"Clutch. Car expenses logbook."),f.createElement(En,null,f.createElement(Sn,{controller:ka,onDeleteData:Sa}),f.createElement(ya,null)))}u().locale("ru"),u().extend(o()),u().extend(l());var wa=new at(Me),xa=new on(Me),ka=new ln,Da=new fn,Ra=document.getElementById("clutch-container"),Ca=(0,p.s)(Ra);(function(){return g.apply(this,arguments)})().then((function(){return function(){return pn.apply(this,arguments)}()})).then((function(){return Promise.all([wa.init(),xa.init(),ka.init()])})).then((function(){Ca.render(f.createElement(m.zt,{store:Me},f.createElement(ga,null)))}))}},r={};function n(e){var a=r[e];if(void 0!==a)return a.exports;var c=r[e]={id:e,loaded:!1,exports:{}};return t[e].call(c.exports,c,c.exports,n),c.loaded=!0,c.exports}n.m=t,e=[],n.O=function(t,r,a,c){if(!r){var u=1/0;for(l=0;l<e.length;l++){r=e[l][0],a=e[l][1],c=e[l][2];for(var i=!0,o=0;o<r.length;o++)(!1&c||u>=c)&&Object.keys(n.O).every((function(e){return n.O[e](r[o])}))?r.splice(o--,1):(i=!1,c<u&&(u=c));if(i){e.splice(l--,1);var s=a();void 0!==s&&(t=s)}}return t}c=c||0;for(var l=e.length;l>0&&e[l-1][2]>c;l--)e[l]=e[l-1];e[l]=[r,a,c]},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,{a:t}),t},n.d=function(e,t){for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.nmd=function(e){return e.paths=[],e.children||(e.children=[]),e},function(){var e={296:0};n.O.j=function(t){return 0===e[t]};var t=function(t,r){var a,c,u=r[0],i=r[1],o=r[2],s=0;if(u.some((function(t){return 0!==e[t]}))){for(a in i)n.o(i,a)&&(n.m[a]=i[a]);if(o)var l=o(n)}for(t&&t(r);s<u.length;s++)c=u[s],n.o(e,c)&&e[c]&&e[c][0](),e[c]=0;return n.O(l)},r=self.webpackChunkclutch=self.webpackChunkclutch||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))}();var a=n.O(void 0,[736],(function(){return n(913)}));a=n.O(a)}();